units           real
atom_style      molecular
special_bonds   lj 0.0 0.0 0.0


### define variables ###
# for run
variable        totalTime equal 100                                            # [ns]
variable        dt equal 5
variable        runstep equal ${totalTime}*1000000/${dt}
variable        run1 equal ${runstep}*0.9
variable        dump equal ${runstep}/100
variable        dump2 equal ${runstep}/10000
variable        fixstress equal ${runstep}/1000
variable        fixrdf equal ${runstep}/1000
variable        thermostep equal ${runstep}/100
variable        restart equal ${runstep}/10

# temperature
variable        temp equal 360.0
variable        Tstart equal 360.0
variable        Tstop equal 360.0
variable        Tdampstep equal 100
variable        Tdamp equal ${dt}*${Tdampstep}

# pressure
variable        Pdampstep equal 1000000
variable        Pdamp equal ${dt}*${Pdampstep}


### simulation settings ###
pair_style      lj96/cut 10
bond_style      harmonic
angle_style     hybrid harmonic gaussian
dihedral_style  nharmonic

read_data       ../PROD/24monomerM512.data
velocity        all create ${Tstart} 19990126 dist gaussian

include         ../PARAM.dat

#neighbor        0.4 bin
neigh_modify    every 1 delay 1 check yes

### compute ###
compute mytemp all temp
compute mypress all pressure mytemp
#variable pxx equal c_mypress[1]
#variable pyy equal c_mypress[2]
#variable pzz equal c_mypress[3]
#variable pxy equal c_mypress[4]
#variable pxz equal c_mypress[5]
#variable pyz equal c_mypress[6]
#variable pxxyy equal v_pxx-v_pyy
#variable pxxzz equal v_pxx-v_pzz
#variable pyyzz equal v_pyy-v_pzz

compute     RDF_AA all rdf 2000 1 1 cutoff 20
compute     RDF_AB all rdf 2000 1 2 cutoff 20
compute     RDF_BB all rdf 2000 2 2 cutoff 20

change_box all triclinic
comm_modify     cutoff 30

#thermo_style custom step temp pe ke etotal epair ebond eangle edihed emol press vol density
thermo_style custom step temp pe ke etotal epair ebond eangle edihed emol press vol density
thermo ${thermostep}

fix 1 all nvt temp ${Tstart} ${Tstop} ${Tdamp}
#fix ave1 all ave/time 1 ${fixstress} ${fixstress} c_mytemp c_mypress file stress.1.txt
fix 2 all langevin ${temp} ${temp} ${Tdamp} 19990126
fix 3 all ave/time 1 ${fixrdf} ${fixrdf} c_RDF_AA[*] file rdf.AA mode vector
fix 4 all ave/time 1 ${fixrdf} ${fixrdf} c_RDF_AB[*] file rdf.AB mode vector
fix 5 all ave/time 1 ${fixrdf} ${fixrdf} c_RDF_BB[*] file rdf.BB mode vector

dump 1 all custom ${dump} dump.1.lammpstrj id xu yu zu

timestep        ${dt}
restart ${restart} restart/res

run ${runstep} upto

write_data      24monomerM512.data
